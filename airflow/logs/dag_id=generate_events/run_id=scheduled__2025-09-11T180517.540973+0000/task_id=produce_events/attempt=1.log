[2025-09-11T18:06:18.884+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-09-11T18:06:19.121+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: generate_events.produce_events scheduled__2025-09-11T18:05:17.540973+00:00 [queued]>
[2025-09-11T18:06:19.158+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: generate_events.produce_events scheduled__2025-09-11T18:05:17.540973+00:00 [queued]>
[2025-09-11T18:06:19.162+0000] {taskinstance.py:1308} INFO - Starting attempt 1 of 2
[2025-09-11T18:06:19.231+0000] {taskinstance.py:1327} INFO - Executing <Task(PythonOperator): produce_events> on 2025-09-11 18:05:17.540973+00:00
[2025-09-11T18:06:19.244+0000] {standard_task_runner.py:57} INFO - Started process 3306 to run task
[2025-09-11T18:06:19.254+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'generate_events', 'produce_events', 'scheduled__2025-09-11T18:05:17.540973+00:00', '--job-id', '157', '--raw', '--subdir', 'DAGS_FOLDER/generator_dag.py', '--cfg-path', '/tmp/tmp6alr_g3w']
[2025-09-11T18:06:19.261+0000] {standard_task_runner.py:85} INFO - Job 157: Subtask produce_events
[2025-09-11T18:06:19.327+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-09-11T18:06:19.480+0000] {task_command.py:410} INFO - Running <TaskInstance: generate_events.produce_events scheduled__2025-09-11T18:05:17.540973+00:00 [running]> on host c905ba028b15
[2025-09-11T18:06:19.558+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-09-11T18:06:20.065+0000] {taskinstance.py:1547} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='generate_events' AIRFLOW_CTX_TASK_ID='produce_events' AIRFLOW_CTX_EXECUTION_DATE='2025-09-11T18:05:17.540973+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-09-11T18:05:17.540973+00:00'
[2025-09-11T18:06:20.085+0000] {conn.py:397} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <connecting> [IPv4 ('172.23.0.5', 29092)]>: connecting to kafka:29092 [('172.23.0.5', 29092) IPv4]
[2025-09-11T18:06:20.207+0000] {conn.py:618} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <checking_api_versions_recv> [IPv4 ('172.23.0.5', 29092)]>: Broker version identified as 2.6
[2025-09-11T18:06:20.209+0000] {conn.py:457} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <connected> [IPv4 ('172.23.0.5', 29092)]>: Connection complete.
[2025-09-11T18:06:24.079+0000] {conn.py:397} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.23.0.5', 29092)]>: connecting to kafka:29092 [('172.23.0.5', 29092) IPv4]
[2025-09-11T18:06:24.082+0000] {conn.py:457} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=kafka:29092 <connected> [IPv4 ('172.23.0.5', 29092)]>: Connection complete.
[2025-09-11T18:06:24.089+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <connected> [IPv4 ('172.23.0.5', 29092)]>: Closing connection. 
[2025-09-11T18:06:24.100+0000] {generator_dag.py:29} INFO - Отправлено событие 1: {'user_id': 256, 'session_id': '3ba61fc5-266c-475b-add3-2371529d624b', 'event_type': 'view_product', 'product_id': 408, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': -24.84763134386978, 'lon': 144.27883415032335, 'cost_usd': 797.12, 'cost_eur': 680.94, 'cost_rub': 67481.05, 'weather_temp': 11.08, 'weather_desc': 'clear sky', 'timestamp': '2025-09-11T18:06:24.071380+00:00'}
[2025-09-11T18:06:28.092+0000] {generator_dag.py:29} INFO - Отправлено событие 2: {'user_id': 298, 'session_id': '9087ee54-56c5-433d-ba22-107947b1bc16', 'event_type': 'view_product', 'product_id': 23, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': 80.36644278819591, 'lon': -76.99969081056128, 'cost_usd': 857.43, 'cost_eur': 732.46, 'cost_rub': 72586.65, 'weather_temp': -1.98, 'weather_desc': 'light snow', 'timestamp': '2025-09-11T18:06:28.089145+00:00'}
[2025-09-11T18:06:31.851+0000] {generator_dag.py:29} INFO - Отправлено событие 3: {'user_id': 329, 'session_id': '00ef7ebe-98df-49eb-8c4b-d396109d4693', 'event_type': 'view_product', 'product_id': 442, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': -72.46699269918291, 'lon': 116.26852524429262, 'cost_usd': 513.05, 'cost_eur': 438.27, 'cost_rub': 43432.8, 'weather_temp': -44.03, 'weather_desc': 'clear sky', 'timestamp': '2025-09-11T18:06:31.843990+00:00'}
[2025-09-11T18:06:36.993+0000] {generator_dag.py:29} INFO - Отправлено событие 4: {'user_id': 873, 'session_id': '0f69b3fe-ca7f-4dc2-9c3b-ed75c6b3754b', 'event_type': 'session_start', 'product_id': None, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': 58.84285232964851, 'lon': -83.37681295803006, 'cost_usd': 727.22, 'cost_eur': 621.22, 'cost_rub': 61563.59, 'weather_temp': 6.14, 'weather_desc': 'overcast clouds', 'timestamp': '2025-09-11T18:06:36.991098+00:00'}
[2025-09-11T18:06:39.979+0000] {generator_dag.py:29} INFO - Отправлено событие 5: {'user_id': 249, 'session_id': '7eac55cf-12bd-4de1-8928-298a27628ff8', 'event_type': 'view_product', 'product_id': 221, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': 10.604354041984791, 'lon': -154.87267742220862, 'cost_usd': 82.17, 'cost_eur': 70.19, 'cost_rub': 6956.19, 'weather_temp': 27.06, 'weather_desc': 'light rain', 'timestamp': '2025-09-11T18:06:39.977247+00:00'}
[2025-09-11T18:06:43.390+0000] {generator_dag.py:29} INFO - Отправлено событие 6: {'user_id': 856, 'session_id': 'b22c43fc-c511-47a7-9b64-c3b787bb09d6', 'event_type': 'add_to_cart', 'product_id': 417, 'order_id': '44ef3a7e-1fb9-4b68-99bb-fe335b7e6444', 'quantity': 3, 'city': 'Unknown', 'country': None, 'lat': -72.93909688931731, 'lon': -24.67809632600418, 'cost_usd': 127.76, 'cost_eur': 109.14, 'cost_rub': 10815.66, 'weather_temp': -22.39, 'weather_desc': 'broken clouds', 'timestamp': '2025-09-11T18:06:43.389058+00:00'}
[2025-09-11T18:06:47.047+0000] {generator_dag.py:29} INFO - Отправлено событие 7: {'user_id': 768, 'session_id': '0125848a-8aa6-4df1-bac1-b8041b02e6b7', 'event_type': 'add_to_cart', 'product_id': 67, 'order_id': 'bd0c72a4-431b-4ac7-97d1-1bea300a27bf', 'quantity': 5, 'city': 'Unknown', 'country': None, 'lat': 75.5852327833189, 'lon': -133.24066780148786, 'cost_usd': 172.24, 'cost_eur': 147.14, 'cost_rub': 14581.16, 'weather_temp': -3.23, 'weather_desc': 'broken clouds', 'timestamp': '2025-09-11T18:06:47.046647+00:00'}
[2025-09-11T18:06:51.872+0000] {generator_dag.py:29} INFO - Отправлено событие 8: {'user_id': 567, 'session_id': 'b61936be-6923-4399-8425-77a99f4b59dd', 'event_type': 'session_start', 'product_id': None, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': -85.54755485506386, 'lon': -38.63389297827962, 'cost_usd': 866.38, 'cost_eur': 740.1, 'cost_rub': 73344.33, 'weather_temp': -37.37, 'weather_desc': 'overcast clouds', 'timestamp': '2025-09-11T18:06:51.868119+00:00'}
[2025-09-11T18:06:56.024+0000] {generator_dag.py:29} INFO - Отправлено событие 9: {'user_id': 76, 'session_id': 'e8456200-6524-43cf-887f-77d8b2d01573', 'event_type': 'view_product', 'product_id': 150, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': -77.13735831408457, 'lon': -62.8401883615269, 'cost_usd': 380.19, 'cost_eur': 324.78, 'cost_rub': 32185.39, 'weather_temp': -33.78, 'weather_desc': 'broken clouds', 'timestamp': '2025-09-11T18:06:56.023882+00:00'}
[2025-09-11T18:07:00.551+0000] {generator_dag.py:29} INFO - Отправлено событие 10: {'user_id': 849, 'session_id': '4d627a4d-935b-424f-bed6-bae94f9edff2', 'event_type': 'add_to_cart', 'product_id': 179, 'order_id': '22036a6a-9463-4df9-9419-b20b7b7c8ba6', 'quantity': 3, 'city': 'Unknown', 'country': None, 'lat': 67.14700581245589, 'lon': 96.45903995062457, 'cost_usd': 826.15, 'cost_eur': 705.73, 'cost_rub': 69938.61, 'weather_temp': 0.66, 'weather_desc': 'overcast clouds', 'timestamp': '2025-09-11T18:07:00.550284+00:00'}
[2025-09-11T18:07:00.555+0000] {kafka.py:629} INFO - <KafkaProducer client_id=kafka-python-producer-1 transactional_id=None>: Closing the Kafka producer with 9223372036.0 secs timeout.
[2025-09-11T18:07:00.557+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=kafka:29092 <connected> [IPv4 ('172.23.0.5', 29092)]>: Closing connection. 
[2025-09-11T18:07:00.558+0000] {generator_dag.py:33} INFO - Генерация завершена.
[2025-09-11T18:07:00.559+0000] {python.py:183} INFO - Done. Returned value was: None
[2025-09-11T18:07:00.615+0000] {taskinstance.py:1350} INFO - Marking task as SUCCESS. dag_id=generate_events, task_id=produce_events, execution_date=20250911T180517, start_date=20250911T180619, end_date=20250911T180700
[2025-09-11T18:07:00.621+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:205 AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
[2025-09-11T18:07:01.276+0000] {local_task_job_runner.py:225} INFO - Task exited with return code 0
[2025-09-11T18:07:01.330+0000] {taskinstance.py:2653} INFO - 0 downstream tasks scheduled from follow-on schedule check

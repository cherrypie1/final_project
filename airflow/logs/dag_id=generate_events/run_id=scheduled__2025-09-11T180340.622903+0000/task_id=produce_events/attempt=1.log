[2025-09-11T18:04:44.575+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-09-11T18:04:44.694+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: generate_events.produce_events scheduled__2025-09-11T18:03:40.622903+00:00 [queued]>
[2025-09-11T18:04:44.706+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: generate_events.produce_events scheduled__2025-09-11T18:03:40.622903+00:00 [queued]>
[2025-09-11T18:04:44.707+0000] {taskinstance.py:1308} INFO - Starting attempt 1 of 2
[2025-09-11T18:04:44.728+0000] {taskinstance.py:1327} INFO - Executing <Task(PythonOperator): produce_events> on 2025-09-11 18:03:40.622903+00:00
[2025-09-11T18:04:44.768+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'generate_events', 'produce_events', 'scheduled__2025-09-11T18:03:40.622903+00:00', '--job-id', '149', '--raw', '--subdir', 'DAGS_FOLDER/generator_dag.py', '--cfg-path', '/tmp/tmppkzvtraz']
[2025-09-11T18:04:44.766+0000] {standard_task_runner.py:57} INFO - Started process 3213 to run task
[2025-09-11T18:04:44.771+0000] {standard_task_runner.py:85} INFO - Job 149: Subtask produce_events
[2025-09-11T18:04:44.804+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-09-11T18:04:44.866+0000] {task_command.py:410} INFO - Running <TaskInstance: generate_events.produce_events scheduled__2025-09-11T18:03:40.622903+00:00 [running]> on host c905ba028b15
[2025-09-11T18:04:44.890+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-09-11T18:04:45.037+0000] {taskinstance.py:1547} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='generate_events' AIRFLOW_CTX_TASK_ID='produce_events' AIRFLOW_CTX_EXECUTION_DATE='2025-09-11T18:03:40.622903+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-09-11T18:03:40.622903+00:00'
[2025-09-11T18:04:45.043+0000] {conn.py:397} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <connecting> [IPv4 ('172.23.0.5', 29092)]>: connecting to kafka:29092 [('172.23.0.5', 29092) IPv4]
[2025-09-11T18:04:45.049+0000] {conn.py:618} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <checking_api_versions_recv> [IPv4 ('172.23.0.5', 29092)]>: Broker version identified as 2.6
[2025-09-11T18:04:45.050+0000] {conn.py:457} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <connected> [IPv4 ('172.23.0.5', 29092)]>: Connection complete.
[2025-09-11T18:04:47.986+0000] {conn.py:397} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.23.0.5', 29092)]>: connecting to kafka:29092 [('172.23.0.5', 29092) IPv4]
[2025-09-11T18:04:47.987+0000] {conn.py:457} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=kafka:29092 <connected> [IPv4 ('172.23.0.5', 29092)]>: Connection complete.
[2025-09-11T18:04:47.988+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <connected> [IPv4 ('172.23.0.5', 29092)]>: Closing connection. 
[2025-09-11T18:04:47.995+0000] {generator_dag.py:29} INFO - Отправлено событие 1: {'user_id': 189, 'session_id': '5d288c9e-7bbb-4b96-8b89-7b55d24ef1ff', 'event_type': 'view_product', 'product_id': 442, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': 58.29075559904291, 'lon': -110.27942303419755, 'cost_usd': 740.09, 'cost_eur': 632.22, 'cost_rub': 62653.11, 'weather_temp': 21.09, 'weather_desc': 'few clouds', 'timestamp': '2025-09-11T18:04:47.984801+00:00'}
[2025-09-11T18:04:51.020+0000] {generator_dag.py:29} INFO - Отправлено событие 2: {'user_id': 109, 'session_id': '7361901f-6a34-4888-8b17-206d887de556', 'event_type': 'view_product', 'product_id': 118, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': 79.7953021693437, 'lon': -104.12973454391229, 'cost_usd': 483.46, 'cost_eur': 412.99, 'cost_rub': 40927.82, 'weather_temp': -4.26, 'weather_desc': 'overcast clouds', 'timestamp': '2025-09-11T18:04:51.019432+00:00'}
[2025-09-11T18:04:55.348+0000] {generator_dag.py:29} INFO - Отправлено событие 3: {'user_id': 613, 'session_id': '796b2371-8346-468a-99da-1b34082a757f', 'event_type': 'session_start', 'product_id': None, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': 10.29531662393623, 'lon': -139.83898401362552, 'cost_usd': 751.54, 'cost_eur': 642.0, 'cost_rub': 63622.42, 'weather_temp': 26.78, 'weather_desc': 'light rain', 'timestamp': '2025-09-11T18:04:55.347143+00:00'}
[2025-09-11T18:04:58.353+0000] {generator_dag.py:29} INFO - Отправлено событие 4: {'user_id': 878, 'session_id': 'd406e302-1c94-42ef-9184-37b1ce28ddae', 'event_type': 'view_product', 'product_id': 98, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': 4.54777631775373, 'lon': -69.64794217082851, 'cost_usd': 174.54, 'cost_eur': 149.1, 'cost_rub': 14775.87, 'weather_temp': 30.35, 'weather_desc': 'broken clouds', 'timestamp': '2025-09-11T18:04:58.351659+00:00'}
[2025-09-11T18:05:02.172+0000] {generator_dag.py:29} INFO - Отправлено событие 5: {'user_id': 792, 'session_id': 'e9a27c55-846c-4856-8fac-5f48e4b6d839', 'event_type': 'session_start', 'product_id': None, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': -49.31084807841833, 'lon': 39.548084104253604, 'cost_usd': 323.37, 'cost_eur': 276.24, 'cost_rub': 27375.23, 'weather_temp': 3.41, 'weather_desc': 'light rain', 'timestamp': '2025-09-11T18:05:02.171736+00:00'}
[2025-09-11T18:05:07.284+0000] {generator_dag.py:29} INFO - Отправлено событие 6: {'user_id': 575, 'session_id': 'b0c4239d-b265-4ff6-9560-7020c9b75914', 'event_type': 'add_to_cart', 'product_id': 421, 'order_id': 'f2e63632-e14e-4b7c-825f-cf2398a455ed', 'quantity': 3, 'city': 'Unknown', 'country': None, 'lat': -59.151114716217904, 'lon': 122.50471192397919, 'cost_usd': 881.54, 'cost_eur': 753.05, 'cost_rub': 74627.71, 'weather_temp': -1.72, 'weather_desc': 'light snow', 'timestamp': '2025-09-11T18:05:07.284003+00:00'}
[2025-09-11T18:05:10.113+0000] {generator_dag.py:29} INFO - Отправлено событие 7: {'user_id': 544, 'session_id': 'a4b8783b-98ad-46d0-a29c-0b01efb5b1d0', 'event_type': 'session_start', 'product_id': None, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': -27.426012941093397, 'lon': -119.7324692314163, 'cost_usd': 131.91, 'cost_eur': 112.68, 'cost_rub': 11166.98, 'weather_temp': 18.47, 'weather_desc': 'light rain', 'timestamp': '2025-09-11T18:05:10.112361+00:00'}
[2025-09-11T18:05:15.207+0000] {generator_dag.py:29} INFO - Отправлено событие 8: {'user_id': 552, 'session_id': 'b47e17a5-684c-41d3-8e1a-481fdaa3e61b', 'event_type': 'purchase', 'product_id': 264, 'order_id': '0509be8c-3358-4f9b-b79a-780b3693de6a', 'quantity': 4, 'city': 'Unknown', 'country': None, 'lat': -64.77891345847979, 'lon': 118.64192482775246, 'cost_usd': 268.09, 'cost_eur': 229.01, 'cost_rub': 22695.45, 'weather_temp': -15.57, 'weather_desc': 'overcast clouds', 'timestamp': '2025-09-11T18:05:15.207302+00:00'}
[2025-09-11T18:05:25.010+0000] {generator_dag.py:29} INFO - Отправлено событие 9: {'user_id': 556, 'session_id': 'dae84be1-71fd-499a-94ae-5f1e7163f2b7', 'event_type': 'session_start', 'product_id': None, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': -46.53848502381434, 'lon': 34.15723668786816, 'cost_usd': 771.79, 'cost_eur': 659.3, 'cost_rub': 65336.71, 'weather_temp': 5.22, 'weather_desc': 'overcast clouds', 'timestamp': '2025-09-11T18:05:25.008720+00:00'}
[2025-09-11T18:05:35.199+0000] {generator_dag.py:29} INFO - Отправлено событие 10: {'user_id': 821, 'session_id': 'f94a3c2a-8e62-4388-bed7-75a0303911a1', 'event_type': 'add_to_cart', 'product_id': 440, 'order_id': '4315a26f-30b3-4017-9735-ae17b1f6e3a3', 'quantity': 3, 'city': 'Unknown', 'country': None, 'lat': 30.248546475525117, 'lon': 114.20876648879852, 'cost_usd': 887.41, 'cost_eur': 758.07, 'cost_rub': 75124.64, 'weather_temp': 25.99, 'weather_desc': 'overcast clouds', 'timestamp': '2025-09-11T18:05:35.197068+00:00'}
[2025-09-11T18:05:35.210+0000] {kafka.py:629} INFO - <KafkaProducer client_id=kafka-python-producer-1 transactional_id=None>: Closing the Kafka producer with 9223372036.0 secs timeout.
[2025-09-11T18:05:35.212+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=kafka:29092 <connected> [IPv4 ('172.23.0.5', 29092)]>: Closing connection. 
[2025-09-11T18:05:35.214+0000] {generator_dag.py:33} INFO - Генерация завершена.
[2025-09-11T18:05:35.217+0000] {python.py:183} INFO - Done. Returned value was: None
[2025-09-11T18:05:35.311+0000] {taskinstance.py:1350} INFO - Marking task as SUCCESS. dag_id=generate_events, task_id=produce_events, execution_date=20250911T180340, start_date=20250911T180444, end_date=20250911T180535
[2025-09-11T18:05:35.324+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:205 AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
[2025-09-11T18:05:35.870+0000] {local_task_job_runner.py:225} INFO - Task exited with return code 0
[2025-09-11T18:05:35.941+0000] {taskinstance.py:2653} INFO - 0 downstream tasks scheduled from follow-on schedule check

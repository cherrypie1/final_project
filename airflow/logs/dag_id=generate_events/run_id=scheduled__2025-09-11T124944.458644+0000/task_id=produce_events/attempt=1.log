[2025-09-11T13:00:19.875+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-09-11T13:00:20.509+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: generate_events.produce_events scheduled__2025-09-11T12:49:44.458644+00:00 [queued]>
[2025-09-11T13:00:20.582+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: generate_events.produce_events scheduled__2025-09-11T12:49:44.458644+00:00 [queued]>
[2025-09-11T13:00:20.586+0000] {taskinstance.py:1308} INFO - Starting attempt 1 of 2
[2025-09-11T13:00:20.769+0000] {taskinstance.py:1327} INFO - Executing <Task(PythonOperator): produce_events> on 2025-09-11 12:49:44.458644+00:00
[2025-09-11T13:00:20.818+0000] {standard_task_runner.py:57} INFO - Started process 222 to run task
[2025-09-11T13:00:21.002+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'generate_events', 'produce_events', 'scheduled__2025-09-11T12:49:44.458644+00:00', '--job-id', '126', '--raw', '--subdir', 'DAGS_FOLDER/generator_dag.py', '--cfg-path', '/tmp/tmpunjnqu8p']
[2025-09-11T13:00:21.574+0000] {standard_task_runner.py:85} INFO - Job 126: Subtask produce_events
[2025-09-11T13:00:22.647+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-09-11T13:00:23.110+0000] {task_command.py:410} INFO - Running <TaskInstance: generate_events.produce_events scheduled__2025-09-11T12:49:44.458644+00:00 [running]> on host c905ba028b15
[2025-09-11T13:00:23.271+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-09-11T13:00:24.028+0000] {taskinstance.py:1547} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='generate_events' AIRFLOW_CTX_TASK_ID='produce_events' AIRFLOW_CTX_EXECUTION_DATE='2025-09-11T12:49:44.458644+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-09-11T12:49:44.458644+00:00'
[2025-09-11T13:00:24.063+0000] {conn.py:397} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <connecting> [IPv4 ('172.23.0.3', 29092)]>: connecting to kafka:29092 [('172.23.0.3', 29092) IPv4]
[2025-09-11T13:00:25.165+0000] {conn.py:618} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <checking_api_versions_recv> [IPv4 ('172.23.0.3', 29092)]>: Broker version identified as 2.6
[2025-09-11T13:00:25.166+0000] {conn.py:457} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <connected> [IPv4 ('172.23.0.3', 29092)]>: Connection complete.
[2025-09-11T13:00:30.391+0000] {conn.py:397} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.23.0.3', 29092)]>: connecting to kafka:29092 [('172.23.0.3', 29092) IPv4]
[2025-09-11T13:00:30.393+0000] {conn.py:457} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=kafka:29092 <connected> [IPv4 ('172.23.0.3', 29092)]>: Connection complete.
[2025-09-11T13:00:30.394+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <connected> [IPv4 ('172.23.0.3', 29092)]>: Closing connection. 
[2025-09-11T13:00:30.697+0000] {generator_dag.py:29} INFO - Отправлено событие 1: {'user_id': 338, 'session_id': '1f56a901-ea10-43e9-bdb5-27c16a6e394e', 'event_type': 'purchase', 'product_id': 16, 'order_id': 'c2dbb1d4-e438-4ae9-bfdc-64b886c19dbf', 'quantity': 1, 'city': 'Antarctica', 'country': 'Antarctica', 'lat': -78.28801016397271, 'lon': -93.29626859353051, 'cost_usd': 940.59, 'cost_eur': 803.49, 'cost_rub': 79626.65, 'weather_temp': -37.06, 'weather_desc': 'broken clouds', 'timestamp': '2025-09-11T13:00:30.387909+00:00'}
[2025-09-11T13:00:32.286+0000] {generator_dag.py:29} INFO - Отправлено событие 2: {'user_id': 259, 'session_id': '1121f309-7b6a-401d-a350-bd4a918f3739', 'event_type': 'session_start', 'product_id': None, 'order_id': None, 'quantity': None, 'city': 'Zhambylskiy', 'country': 'Kazakhstan', 'lat': 43.75300652177066, 'lon': 75.86846349683583, 'cost_usd': 519.88, 'cost_eur': 444.1, 'cost_rub': 44011.0, 'weather_temp': 21.7, 'weather_desc': 'overcast clouds', 'timestamp': '2025-09-11T13:00:32.285127+00:00'}
[2025-09-11T13:00:33.483+0000] {generator_dag.py:29} INFO - Отправлено событие 3: {'user_id': 574, 'session_id': '909c8ecf-2f0c-47ce-a3ff-8e1ba4cbb020', 'event_type': 'purchase', 'product_id': 363, 'order_id': 'ee3b5cad-a00a-473b-8883-c13e7e871a68', 'quantity': 1, 'city': 'Dagana', 'country': 'Chad', 'lat': 12.984363724057388, 'lon': 15.589581682150538, 'cost_usd': 815.28, 'cost_eur': 696.45, 'cost_rub': 69018.4, 'weather_temp': 33.83, 'weather_desc': 'overcast clouds', 'timestamp': '2025-09-11T13:00:33.482778+00:00'}
[2025-09-11T13:00:34.989+0000] {generator_dag.py:29} INFO - Отправлено событие 4: {'user_id': 239, 'session_id': '03de1e96-8c12-4289-b7e7-348c6fa9acbe', 'event_type': 'session_start', 'product_id': None, 'order_id': None, 'quantity': None, 'city': 'Ali', 'country': 'China', 'lat': 33.989861420073396, 'lon': 84.22552044626815, 'cost_usd': 600.4, 'cost_eur': 512.89, 'cost_rub': 50827.5, 'weather_temp': 9.24, 'weather_desc': 'clear sky', 'timestamp': '2025-09-11T13:00:34.988587+00:00'}
[2025-09-11T13:00:35.867+0000] {generator_dag.py:29} INFO - Отправлено событие 5: {'user_id': 856, 'session_id': '7f05336e-234d-44e5-8fee-d93257c15af5', 'event_type': 'view_product', 'product_id': 451, 'order_id': None, 'quantity': None, 'city': 'Go Quao', 'country': 'Vietnam', 'lat': 9.68843599166803, 'lon': 105.2644726627633, 'cost_usd': 163.75, 'cost_eur': 139.88, 'cost_rub': 13862.43, 'weather_temp': 26.75, 'weather_desc': 'few clouds', 'timestamp': '2025-09-11T13:00:35.866827+00:00'}
[2025-09-11T13:00:37.378+0000] {generator_dag.py:29} INFO - Отправлено событие 6: {'user_id': 801, 'session_id': 'f4dd0cac-2779-4da5-b866-ae912ca22876', 'event_type': 'view_product', 'product_id': 299, 'order_id': None, 'quantity': None, 'city': 'Coronel Prestes', 'country': 'Brazil', 'lat': -30.839085470832543, 'lon': -52.748150070687274, 'cost_usd': 594.13, 'cost_eur': 507.53, 'cost_rub': 50296.71, 'weather_temp': 18.01, 'weather_desc': 'clear sky', 'timestamp': '2025-09-11T13:00:37.377704+00:00'}
[2025-09-11T13:00:38.243+0000] {generator_dag.py:29} INFO - Отправлено событие 7: {'user_id': 785, 'session_id': '7536612d-38f8-48fb-82df-d9e131544621', 'event_type': 'session_start', 'product_id': None, 'order_id': None, 'quantity': None, 'city': 'Antarctica', 'country': 'Antarctica', 'lat': -78.08206571584043, 'lon': -153.78605074940276, 'cost_usd': 491.14, 'cost_eur': 419.55, 'cost_rub': 41577.98, 'weather_temp': -18.11, 'weather_desc': 'overcast clouds', 'timestamp': '2025-09-11T13:00:38.242746+00:00'}
[2025-09-11T13:00:39.021+0000] {generator_dag.py:29} INFO - Отправлено событие 8: {'user_id': 332, 'session_id': '44473097-3851-45b9-b293-b702ccf60c1f', 'event_type': 'purchase', 'product_id': 361, 'order_id': '23c299a0-1ff3-43da-8115-1052e9d422f4', 'quantity': 4, 'city': 'Region 1', 'country': 'Canada', 'lat': 67.93521129760833, 'lon': -122.64153032759565, 'cost_usd': 482.14, 'cost_eur': 411.87, 'cost_rub': 40816.08, 'weather_temp': 8.76, 'weather_desc': 'overcast clouds', 'timestamp': '2025-09-11T13:00:39.020941+00:00'}
[2025-09-11T13:00:39.968+0000] {generator_dag.py:29} INFO - Отправлено событие 9: {'user_id': 553, 'session_id': '1513b10f-1259-4a51-ac92-804fb3d90c6d', 'event_type': 'view_product', 'product_id': 135, 'order_id': None, 'quantity': None, 'city': 'Antarctica', 'country': 'Antarctica', 'lat': -89.22990753349384, 'lon': -108.41327606684774, 'cost_usd': 859.16, 'cost_eur': 733.93, 'cost_rub': 72733.11, 'weather_temp': -42.8, 'weather_desc': 'overcast clouds', 'timestamp': '2025-09-11T13:00:39.967478+00:00'}
[2025-09-11T13:00:43.400+0000] {generator_dag.py:29} INFO - Отправлено событие 10: {'user_id': 94, 'session_id': 'b42089db-9b64-497b-b019-fec6d02a93d3', 'event_type': 'session_start', 'product_id': None, 'order_id': None, 'quantity': None, 'city': 'Oljokminskiy', 'country': 'Russia', 'lat': 60.5193026486115, 'lon': 119.46739227616939, 'cost_usd': 485.1, 'cost_eur': 414.39, 'cost_rub': 41066.66, 'weather_temp': 10.25, 'weather_desc': 'overcast clouds', 'timestamp': '2025-09-11T13:00:43.399238+00:00'}
[2025-09-11T13:00:43.423+0000] {kafka.py:629} INFO - <KafkaProducer client_id=kafka-python-producer-1 transactional_id=None>: Closing the Kafka producer with 9223372036.0 secs timeout.
[2025-09-11T13:00:43.424+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=kafka:29092 <connected> [IPv4 ('172.23.0.3', 29092)]>: Closing connection. 
[2025-09-11T13:00:43.426+0000] {generator_dag.py:33} INFO - Генерация завершена.
[2025-09-11T13:00:43.427+0000] {python.py:183} INFO - Done. Returned value was: None
[2025-09-11T13:00:43.496+0000] {taskinstance.py:1350} INFO - Marking task as SUCCESS. dag_id=generate_events, task_id=produce_events, execution_date=20250911T124944, start_date=20250911T130020, end_date=20250911T130043
[2025-09-11T13:00:43.499+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:205 AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
[2025-09-11T13:00:43.970+0000] {local_task_job_runner.py:225} INFO - Task exited with return code 0
[2025-09-11T13:00:44.008+0000] {taskinstance.py:2653} INFO - 0 downstream tasks scheduled from follow-on schedule check

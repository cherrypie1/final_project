[2025-09-11T18:01:29.113+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-09-11T18:01:29.253+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: generate_events.produce_events scheduled__2025-09-11T17:45:51.065106+00:00 [queued]>
[2025-09-11T18:01:29.266+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: generate_events.produce_events scheduled__2025-09-11T17:45:51.065106+00:00 [queued]>
[2025-09-11T18:01:29.267+0000] {taskinstance.py:1308} INFO - Starting attempt 2 of 2
[2025-09-11T18:01:29.295+0000] {taskinstance.py:1327} INFO - Executing <Task(PythonOperator): produce_events> on 2025-09-11 17:45:51.065106+00:00
[2025-09-11T18:01:29.305+0000] {standard_task_runner.py:57} INFO - Started process 3049 to run task
[2025-09-11T18:01:29.308+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'generate_events', 'produce_events', 'scheduled__2025-09-11T17:45:51.065106+00:00', '--job-id', '147', '--raw', '--subdir', 'DAGS_FOLDER/generator_dag.py', '--cfg-path', '/tmp/tmphcbzhysc']
[2025-09-11T18:01:29.312+0000] {standard_task_runner.py:85} INFO - Job 147: Subtask produce_events
[2025-09-11T18:01:29.344+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-09-11T18:01:29.405+0000] {task_command.py:410} INFO - Running <TaskInstance: generate_events.produce_events scheduled__2025-09-11T17:45:51.065106+00:00 [running]> on host c905ba028b15
[2025-09-11T18:01:29.429+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-09-11T18:01:29.552+0000] {taskinstance.py:1547} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='generate_events' AIRFLOW_CTX_TASK_ID='produce_events' AIRFLOW_CTX_EXECUTION_DATE='2025-09-11T17:45:51.065106+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-09-11T17:45:51.065106+00:00'
[2025-09-11T18:01:29.560+0000] {conn.py:397} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <connecting> [IPv4 ('172.23.0.5', 29092)]>: connecting to kafka:29092 [('172.23.0.5', 29092) IPv4]
[2025-09-11T18:01:29.771+0000] {conn.py:618} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <checking_api_versions_recv> [IPv4 ('172.23.0.5', 29092)]>: Broker version identified as 2.6
[2025-09-11T18:01:29.772+0000] {conn.py:457} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <connected> [IPv4 ('172.23.0.5', 29092)]>: Connection complete.
[2025-09-11T18:01:37.042+0000] {conn.py:397} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.23.0.5', 29092)]>: connecting to kafka:29092 [('172.23.0.5', 29092) IPv4]
[2025-09-11T18:01:37.044+0000] {conn.py:457} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=kafka:29092 <connected> [IPv4 ('172.23.0.5', 29092)]>: Connection complete.
[2025-09-11T18:01:37.045+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <connected> [IPv4 ('172.23.0.5', 29092)]>: Closing connection. 
[2025-09-11T18:01:37.088+0000] {generator_dag.py:29} INFO - Отправлено событие 1: {'user_id': 811, 'session_id': '388e03b1-4538-46ad-a90a-be4343aef84b', 'event_type': 'purchase', 'product_id': 275, 'order_id': '6f6a3739-1ee8-4379-92cd-2dd02d9cbf0f', 'quantity': 4, 'city': 'Unknown', 'country': None, 'lat': -55.70847851760858, 'lon': 54.79724437841918, 'cost_usd': 969.06, 'cost_eur': 827.81, 'cost_rub': 82036.81, 'weather_temp': 0.15, 'weather_desc': 'overcast clouds', 'timestamp': '2025-09-11T18:01:37.036859+00:00'}
[2025-09-11T18:01:42.013+0000] {generator_dag.py:29} INFO - Отправлено событие 2: {'user_id': 376, 'session_id': 'b72e4e93-eee0-45c2-98e2-5ba04547622d', 'event_type': 'view_product', 'product_id': 30, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': 26.286598631491174, 'lon': -135.1090264503726, 'cost_usd': 776.95, 'cost_eur': 663.71, 'cost_rub': 65773.53, 'weather_temp': 22.98, 'weather_desc': 'clear sky', 'timestamp': '2025-09-11T18:01:42.012615+00:00'}
[2025-09-11T18:01:46.086+0000] {generator_dag.py:29} INFO - Отправлено событие 3: {'user_id': 865, 'session_id': '60a294bd-45f5-485a-a643-e80796f7f5f5', 'event_type': 'session_start', 'product_id': None, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': 70.06871863525714, 'lon': 142.69689022425575, 'cost_usd': 783.38, 'cost_eur': 669.2, 'cost_rub': 66317.87, 'weather_temp': 2.9, 'weather_desc': 'overcast clouds', 'timestamp': '2025-09-11T18:01:46.085027+00:00'}
[2025-09-11T18:01:50.271+0000] {generator_dag.py:29} INFO - Отправлено событие 4: {'user_id': 665, 'session_id': '43ffe872-2887-4956-a718-49ac42d974ba', 'event_type': 'view_product', 'product_id': 484, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': -34.739651193591875, 'lon': -64.96564810669045, 'cost_usd': 621.83, 'cost_eur': 531.2, 'cost_rub': 52641.68, 'weather_temp': 23.17, 'weather_desc': 'clear sky', 'timestamp': '2025-09-11T18:01:50.270380+00:00'}
[2025-09-11T18:01:54.275+0000] {generator_dag.py:29} INFO - Отправлено событие 5: {'user_id': 987, 'session_id': '9d723139-980d-4c47-a291-fddc0154b5b5', 'event_type': 'add_to_cart', 'product_id': 229, 'order_id': '0bf49cf8-a088-4b45-9a46-92be010eb5d9', 'quantity': 4, 'city': 'Unknown', 'country': None, 'lat': -84.49776800297975, 'lon': -69.11456684548725, 'cost_usd': 57.33, 'cost_eur': 48.97, 'cost_rub': 4853.33, 'weather_temp': -31.92, 'weather_desc': 'overcast clouds', 'timestamp': '2025-09-11T18:01:54.274222+00:00'}
[2025-09-11T18:01:57.728+0000] {generator_dag.py:29} INFO - Отправлено событие 6: {'user_id': 551, 'session_id': 'bf7c0db0-511e-4921-b624-7660ec3bb2d6', 'event_type': 'session_start', 'product_id': None, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': -48.44005682299031, 'lon': 98.55159269924229, 'cost_usd': 713.79, 'cost_eur': 609.75, 'cost_rub': 60426.66, 'weather_temp': 2.24, 'weather_desc': 'light rain', 'timestamp': '2025-09-11T18:01:57.727092+00:00'}
[2025-09-11T18:02:01.322+0000] {generator_dag.py:29} INFO - Отправлено событие 7: {'user_id': 384, 'session_id': '238edba9-c420-4f45-9dd7-94547f4e0ed0', 'event_type': 'session_start', 'product_id': None, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': -37.51706595271727, 'lon': -113.86052795498544, 'cost_usd': 18.2, 'cost_eur': 15.55, 'cost_rub': 1540.74, 'weather_temp': 10.98, 'weather_desc': 'few clouds', 'timestamp': '2025-09-11T18:02:01.321001+00:00'}
[2025-09-11T18:02:06.212+0000] {generator_dag.py:29} INFO - Отправлено событие 8: {'user_id': 746, 'session_id': '313a73f5-5c03-41af-b272-1f0141c225da', 'event_type': 'purchase', 'product_id': 82, 'order_id': '01075353-d142-43af-ac09-714cbe32c1c3', 'quantity': 1, 'city': 'Unknown', 'country': None, 'lat': 67.74272822164772, 'lon': -177.70010677607797, 'cost_usd': 69.23, 'cost_eur': 59.14, 'cost_rub': 5860.74, 'weather_temp': 0.61, 'weather_desc': 'overcast clouds', 'timestamp': '2025-09-11T18:02:06.210072+00:00'}
[2025-09-11T18:02:12.476+0000] {generator_dag.py:29} INFO - Отправлено событие 9: {'user_id': 851, 'session_id': '232e5f76-032d-495f-b89d-adb66d9c1adb', 'event_type': 'purchase', 'product_id': 399, 'order_id': 'a197071b-e7ea-4e74-a806-a372bdfacfc8', 'quantity': 1, 'city': 'Unknown', 'country': None, 'lat': 42.40482238711246, 'lon': 43.07556160902155, 'cost_usd': 992.04, 'cost_eur': 847.45, 'cost_rub': 83982.21, 'weather_temp': 11.84, 'weather_desc': 'light rain', 'timestamp': '2025-09-11T18:02:12.474649+00:00'}
[2025-09-11T18:02:17.436+0000] {generator_dag.py:29} INFO - Отправлено событие 10: {'user_id': 621, 'session_id': '4ba44e65-63dd-457a-a899-2fc292a2f2ba', 'event_type': 'view_product', 'product_id': 253, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': 18.40226906386954, 'lon': 4.0889050299125245, 'cost_usd': 25.89, 'cost_eur': 22.12, 'cost_rub': 2191.75, 'weather_temp': 34.56, 'weather_desc': 'broken clouds', 'timestamp': '2025-09-11T18:02:17.434467+00:00'}
[2025-09-11T18:02:17.478+0000] {kafka.py:629} INFO - <KafkaProducer client_id=kafka-python-producer-1 transactional_id=None>: Closing the Kafka producer with 9223372036.0 secs timeout.
[2025-09-11T18:02:17.481+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=kafka:29092 <connected> [IPv4 ('172.23.0.5', 29092)]>: Closing connection. 
[2025-09-11T18:02:17.484+0000] {generator_dag.py:33} INFO - Генерация завершена.
[2025-09-11T18:02:17.498+0000] {python.py:183} INFO - Done. Returned value was: None
[2025-09-11T18:02:17.751+0000] {taskinstance.py:1350} INFO - Marking task as SUCCESS. dag_id=generate_events, task_id=produce_events, execution_date=20250911T174551, start_date=20250911T180129, end_date=20250911T180217
[2025-09-11T18:02:17.780+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:205 AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
[2025-09-11T18:02:18.505+0000] {local_task_job_runner.py:225} INFO - Task exited with return code 0
[2025-09-11T18:02:18.625+0000] {taskinstance.py:2653} INFO - 0 downstream tasks scheduled from follow-on schedule check

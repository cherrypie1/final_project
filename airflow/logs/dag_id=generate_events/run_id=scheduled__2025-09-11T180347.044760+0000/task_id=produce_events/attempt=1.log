[2025-09-11T18:04:49.307+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-09-11T18:04:49.441+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: generate_events.produce_events scheduled__2025-09-11T18:03:47.044760+00:00 [queued]>
[2025-09-11T18:04:49.457+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: generate_events.produce_events scheduled__2025-09-11T18:03:47.044760+00:00 [queued]>
[2025-09-11T18:04:49.458+0000] {taskinstance.py:1308} INFO - Starting attempt 1 of 2
[2025-09-11T18:04:49.492+0000] {taskinstance.py:1327} INFO - Executing <Task(PythonOperator): produce_events> on 2025-09-11 18:03:47.044760+00:00
[2025-09-11T18:04:49.502+0000] {standard_task_runner.py:57} INFO - Started process 3233 to run task
[2025-09-11T18:04:49.506+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'generate_events', 'produce_events', 'scheduled__2025-09-11T18:03:47.044760+00:00', '--job-id', '150', '--raw', '--subdir', 'DAGS_FOLDER/generator_dag.py', '--cfg-path', '/tmp/tmpn32lulx4']
[2025-09-11T18:04:49.509+0000] {standard_task_runner.py:85} INFO - Job 150: Subtask produce_events
[2025-09-11T18:04:49.540+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/settings.py:195 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-09-11T18:04:49.617+0000] {task_command.py:410} INFO - Running <TaskInstance: generate_events.produce_events scheduled__2025-09-11T18:03:47.044760+00:00 [running]> on host c905ba028b15
[2025-09-11T18:04:49.644+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/sqlalchemy.py:124 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-09-11T18:04:49.796+0000] {taskinstance.py:1547} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='generate_events' AIRFLOW_CTX_TASK_ID='produce_events' AIRFLOW_CTX_EXECUTION_DATE='2025-09-11T18:03:47.044760+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-09-11T18:03:47.044760+00:00'
[2025-09-11T18:04:49.804+0000] {conn.py:397} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <connecting> [IPv4 ('172.23.0.5', 29092)]>: connecting to kafka:29092 [('172.23.0.5', 29092) IPv4]
[2025-09-11T18:04:49.812+0000] {conn.py:618} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <checking_api_versions_recv> [IPv4 ('172.23.0.5', 29092)]>: Broker version identified as 2.6
[2025-09-11T18:04:49.813+0000] {conn.py:457} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <connected> [IPv4 ('172.23.0.5', 29092)]>: Connection complete.
[2025-09-11T18:04:53.674+0000] {conn.py:397} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.23.0.5', 29092)]>: connecting to kafka:29092 [('172.23.0.5', 29092) IPv4]
[2025-09-11T18:04:53.676+0000] {conn.py:457} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=kafka:29092 <connected> [IPv4 ('172.23.0.5', 29092)]>: Connection complete.
[2025-09-11T18:04:53.677+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <connected> [IPv4 ('172.23.0.5', 29092)]>: Closing connection. 
[2025-09-11T18:04:53.687+0000] {generator_dag.py:29} INFO - Отправлено событие 1: {'user_id': 119, 'session_id': 'e2ad6f70-3b94-4667-9ea5-ae9a49482b41', 'event_type': 'view_product', 'product_id': 328, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': -54.972207158651536, 'lon': -175.53129604230534, 'cost_usd': 668.45, 'cost_eur': 571.02, 'cost_rub': 56588.35, 'weather_temp': 5.11, 'weather_desc': 'broken clouds', 'timestamp': '2025-09-11T18:04:53.671405+00:00'}
[2025-09-11T18:04:57.226+0000] {generator_dag.py:29} INFO - Отправлено событие 2: {'user_id': 291, 'session_id': '00d4da00-c3dd-48ef-85a0-7ce7499cf171', 'event_type': 'add_to_cart', 'product_id': 112, 'order_id': 'a6c999e5-e7dd-459a-bf94-77c925ad1596', 'quantity': 1, 'city': 'Unknown', 'country': None, 'lat': 27.27230970509696, 'lon': 35.42495249162843, 'cost_usd': 635.88, 'cost_eur': 543.2, 'cost_rub': 53831.1, 'weather_temp': 29.09, 'weather_desc': 'clear sky', 'timestamp': '2025-09-11T18:04:57.224856+00:00'}
[2025-09-11T18:05:00.714+0000] {generator_dag.py:29} INFO - Отправлено событие 3: {'user_id': 324, 'session_id': '6fd61e0d-0290-47bc-a666-1f53458f0ee8', 'event_type': 'add_to_cart', 'product_id': 160, 'order_id': '1bc39cb5-5552-4a4e-a05f-4f78c4fce58a', 'quantity': 4, 'city': 'Unknown', 'country': None, 'lat': 31.552646200124812, 'lon': 20.875006775477004, 'cost_usd': 567.38, 'cost_eur': 484.68, 'cost_rub': 48032.16, 'weather_temp': 29.98, 'weather_desc': 'clear sky', 'timestamp': '2025-09-11T18:05:00.712851+00:00'}
[2025-09-11T18:05:04.341+0000] {generator_dag.py:29} INFO - Отправлено событие 4: {'user_id': 702, 'session_id': 'de9bc49a-dcf0-4074-9399-e8009ddbca95', 'event_type': 'session_start', 'product_id': None, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': -38.00918845108404, 'lon': 154.2851702888476, 'cost_usd': 420.84, 'cost_eur': 359.5, 'cost_rub': 35626.66, 'weather_temp': 13.85, 'weather_desc': 'few clouds', 'timestamp': '2025-09-11T18:05:04.337492+00:00'}
[2025-09-11T18:05:08.650+0000] {generator_dag.py:29} INFO - Отправлено событие 5: {'user_id': 139, 'session_id': '7de022aa-8213-4cd6-94d9-d177a250b4ac', 'event_type': 'session_start', 'product_id': None, 'order_id': None, 'quantity': None, 'city': 'Unknown', 'country': None, 'lat': 5.118602072165359, 'lon': 39.681360970742475, 'cost_usd': 78.35, 'cost_eur': 66.93, 'cost_rub': 6632.8, 'weather_temp': 22.4, 'weather_desc': 'overcast clouds', 'timestamp': '2025-09-11T18:05:08.649610+00:00'}
[2025-09-11T18:05:11.536+0000] {generator_dag.py:29} INFO - Отправлено событие 6: {'user_id': 340, 'session_id': '10c11697-a2c8-4077-bbb9-b7eda2acc68d', 'event_type': 'purchase', 'product_id': 482, 'order_id': '84605679-bc15-4514-b56b-416a7d2247d9', 'quantity': 5, 'city': 'Unknown', 'country': None, 'lat': 46.49602746799616, 'lon': 156.25710750325123, 'cost_usd': 126.98, 'cost_eur': 108.47, 'cost_rub': 10749.63, 'weather_temp': 12.44, 'weather_desc': 'overcast clouds', 'timestamp': '2025-09-11T18:05:11.535066+00:00'}
[2025-09-11T18:05:16.390+0000] {generator_dag.py:29} INFO - Отправлено событие 7: {'user_id': 358, 'session_id': '100b5aa7-ad3e-4c33-8338-96889432fa2c', 'event_type': 'add_to_cart', 'product_id': 96, 'order_id': '8a18e39b-9173-424e-a637-abd5e5d4fe8b', 'quantity': 4, 'city': 'Unknown', 'country': None, 'lat': 85.25761380401909, 'lon': -157.40823073886781, 'cost_usd': 811.2, 'cost_eur': 692.96, 'cost_rub': 68673.0, 'weather_temp': -2.06, 'weather_desc': 'light snow', 'timestamp': '2025-09-11T18:05:16.388266+00:00'}
[2025-09-11T18:05:27.952+0000] {generator_dag.py:29} INFO - Отправлено событие 8: {'user_id': 848, 'session_id': 'b011cf5b-9268-427b-b42b-5dcd00af963d', 'event_type': 'add_to_cart', 'product_id': 87, 'order_id': '629cab0c-07c2-4480-ad4b-f4093b498829', 'quantity': 3, 'city': 'Unknown', 'country': None, 'lat': 82.10200114702079, 'lon': -39.983965943435464, 'cost_usd': 709.25, 'cost_eur': 605.87, 'cost_rub': 60042.32, 'weather_temp': -12.08, 'weather_desc': 'clear sky', 'timestamp': '2025-09-11T18:05:27.951030+00:00'}
[2025-09-11T18:05:39.041+0000] {generator_dag.py:29} INFO - Отправлено событие 9: {'user_id': 460, 'session_id': '8e2bfc7a-69bc-4359-a3d8-c4fe2e34673f', 'event_type': 'purchase', 'product_id': 323, 'order_id': '65fb28d8-3d73-4994-b59c-3e8152afe401', 'quantity': 2, 'city': 'Unknown', 'country': None, 'lat': 19.393967374534952, 'lon': 28.60284079235143, 'cost_usd': 487.48, 'cost_eur': 416.43, 'cost_rub': 41268.14, 'weather_temp': 32.36, 'weather_desc': 'clear sky', 'timestamp': '2025-09-11T18:05:39.040815+00:00'}
[2025-09-11T18:05:46.987+0000] {generator_dag.py:29} INFO - Отправлено событие 10: {'user_id': 687, 'session_id': 'ad6675f3-c87b-4ba4-9dea-3ef3ec03e8a0', 'event_type': 'add_to_cart', 'product_id': 302, 'order_id': '6655f7d6-80bb-4e27-8491-9dd5d301454f', 'quantity': 3, 'city': 'Unknown', 'country': None, 'lat': -54.39412188991651, 'lon': -135.20266052745592, 'cost_usd': 94.34, 'cost_eur': 80.59, 'cost_rub': 7986.45, 'weather_temp': 4.86, 'weather_desc': 'light rain', 'timestamp': '2025-09-11T18:05:46.985328+00:00'}
[2025-09-11T18:05:46.993+0000] {kafka.py:629} INFO - <KafkaProducer client_id=kafka-python-producer-1 transactional_id=None>: Closing the Kafka producer with 9223372036.0 secs timeout.
[2025-09-11T18:05:46.995+0000] {conn.py:945} INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=kafka:29092 <connected> [IPv4 ('172.23.0.5', 29092)]>: Closing connection. 
[2025-09-11T18:05:46.997+0000] {generator_dag.py:33} INFO - Генерация завершена.
[2025-09-11T18:05:46.999+0000] {python.py:183} INFO - Done. Returned value was: None
[2025-09-11T18:05:47.062+0000] {taskinstance.py:1350} INFO - Marking task as SUCCESS. dag_id=generate_events, task_id=produce_events, execution_date=20250911T180347, start_date=20250911T180449, end_date=20250911T180547
[2025-09-11T18:05:47.069+0000] {logging_mixin.py:150} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:205 AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
[2025-09-11T18:05:47.640+0000] {local_task_job_runner.py:225} INFO - Task exited with return code 0
[2025-09-11T18:05:47.715+0000] {taskinstance.py:2653} INFO - 0 downstream tasks scheduled from follow-on schedule check
